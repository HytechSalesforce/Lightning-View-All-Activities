<apex:page controller="SH2.DSH_Setting_Management_Controller" sidebar="false" applyBodyTag="false" docType="html-5.0">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <head> 
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
        <apex:stylesheet value="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/styles/salesforce-lightning-design-system-vf.min.css')}" />
        
        <apex:stylesheet value="{! URLFOR($Resource.HS_Jquery, 'jquery-ui.min.css')}" />
        <apex:includeScript value="{! URLFOR($Resource.HS_Jquery, 'jquery-1.12.1.min.js')}" />
        <apex:includeScript value="{! URLFOR($Resource.HS_Jquery, 'jquery-ui.min.js')}" />
         
        <apex:stylesheet value="{!$Resource.SH2__PT_TimePicker_CSS}"/>
        <apex:includeScript value="{!$Resource.SH2__PT_TimePicker_JS}"/>
        
        <apex:includeScript value="{!$Resource.SH2__DSH_Utility_JS}"/>
        
    </head>
    
    <style>
        
        tr[class="slds-hint-parent"] { }
        #datePicker {
          z-index: 10000;
        }
        
    </style>
    
    <script>
    
    var dsh = dsh || {};
    dsh.j$ = jQuery.noConflict();
 
    function updateSetting(){
        if(!isBlank(dsh.j$("[Id$='editObjectList']").val())){ 
            updateSettingAction();
        }
        else{
            showEditObjectError();
        }
    }
    
    function previewRecords(){
        displayRecordPreview();
    }
    
    function selectSetting(settingId, nameError, context){
        if(!isBlank(settingId) && isBlank(nameError)){
            selectSettingAction(settingId);
        }
        processSelectedSetting(settingId, nameError, context);
    }
    
    function saveSettingConfig(){
        validEmail = true;
        
        if(!isBlank(dsh.j$("[Id$='emailAddress']").val())){
          for(i = 0; i < dsh.j$("[Id$='emailAddress']").val().split(',').length; i++){
            if(!isValidEmail(dsh.j$("[Id$='emailAddress']").val().split(',')[i].trim())){
              validEmail = false;
            }
          }
        }
        
        if((isBlank(dsh.j$("[Id$='emailAddress']").val()) || validEmail) && (!isGreaterThanMaxLimit(dsh.j$("[Id$='maxRecordsToDelete']").val()) || isBlank(dsh.j$("[Id$='maxRecordsToDelete']").val()))){
            settingConfigUpdate();
            hideSettingConfig();
        }else{
            if(isGreaterThanMaxLimit(dsh.j$("[Id$='maxRecordsToDelete']").val())){
              showMaxRecordsError();
            }else{
              showEmailError();
            }
        }
    }
    
    function newSetting(){
        clearSelectedCriterion();
        showNewSetting();
    }
    
    function newSettingFilter(){
        if(!isBlank(dsh.j$("[Id$='objectList']").val())){
            saveSetting();
        }
        else{
            showNewObjectError();
        }
    }
    
    function saveSettingCriteria(hasFilterCriteriaVariable){
        if(!isBlank(dsh.j$("[Id$='objFields']").val()) && !isBlank(dsh.j$("[Id$='NewCriteriaOper']").val()) && (!hasFilterCriteriaVariable || (hasFilterCriteriaVariable && !isBlank(dsh.j$("[Id$='newFilterCon']").val())))){
            saveCriteria();
            hideNewCriteriaVariableError();
        }else{
          if(isBlank(dsh.j$("[Id$='newFilterCon']").val())){
            showNewCriteriaVariableError();
          }
          else if(isBlank(dsh.j$("[Id$='objFields']").val())){
            showNewCriteriaFieldError();
          }
          else{
            showNewCriteriaOperError();
          }
        }
    }
    
    function activateSetting(){
        activate();
        hideAllModals();
    }
    
    function updateSettingCriteria(hasFilterCriteriaVariable){
        if(!isBlank(dsh.j$("[Id$='filterField']").val()) && !isBlank(dsh.j$("[Id$='EditCriteriaOper']").val()) && (!hasFilterCriteriaVariable || (hasFilterCriteriaVariable && !isBlank(dsh.j$("[Id$='editFilterCon']").val())))){
            updateCriteria();
            hideEditCriteriaVariableError();
        }else{
          if(isBlank(dsh.j$("[Id$='editFilterCon']").val())){
            showEditCriteriaVariableError();
          }
          else if(isBlank(dsh.j$("[Id$='filterField']").val())){
            showEditCriteriaFieldError();
          }else{
            showEditCriteriaOperError();
          }
        }
    }
    
    function hideNewCriterionAfterSave(error, active, showBackupConfigModal){
        if(isBlank(error)){
            if(showBackupConfigModal){
              showBackupConfig();
            }
            clearSelectedCriterion();
            hideNewCriterion();
            hideError('newConditionError');
        }else{
            showNewCriterion();
            showError(error, 'newConditionError');
        }
    }
    
    function hideEditCriterionAfterSave(error){
        if(isBlank(error)){
            clearSelectedCriterion();
            hideEditCriterion();
            hideError('editConditionError');
        }else{
            showEditCriterion();
            showError(error, 'editConditionError');
        }
    }
    
    function hideChildBackupConfig(){
        hideBackupChildObjects();
        showBackupConfig();
    }
    
    function showAdditionalCriterionModal(error){
        if(isBlank(error)){
          addCriterion();
          showNewCriterion();
        }else{
          showNewCriterion();
          showError(error, 'newConditionError');
        }
    }
    
    function editCriterion(criterionId){
        selectCriterionAction(criterionId);
        showEditCriterion();
    }
    
    function deleteSettingButton(){
        showDeletionWarning();
    }
    
    function addAdditionalCriteria(){
        clearSelectedCriterion();
        showNewCriterion();
        shouldNotShowBackupConfig();
    }
    
    function addCriteria(){
        showNewCriterion();
    }
    
    function updateFilterLogic(){
        editLogic();
    }
    
    function addAdditionalCriterion(){
        addSettingCriteria();
    }
    
    function deleteSelectedCriterion(criterionId){
        deleteCriterionAction(criterionId);
    }
    
    function saveSchedule(){
      if(dsh.j$("[Id$='selectedRunMode']").val() == 'Scheduled'){
        if(!isBlank(dsh.j$("[Id$='nextRun']").val()) && !isBlank(dsh.j$("[Id$='increment']").val()) && dsh.j$("[Id$='increment']").val() > 0 && dsh.j$("[Id$='increment']").val().indexOf('.') < 0){
          scheduleUpdate();
        }else{
          if(isBlank(dsh.j$("[Id$='nextRun']").val())){
            showNextRunError();
          }
          if(isBlank(dsh.j$("[Id$='increment']").val()) || dsh.j$("[Id$='increment']").val() < 1 || dsh.j$("[Id$='increment']").val().indexOf('.') >= 0){
            showIncrementError();
          }
        }
      }else{
        scheduleUpdate();
      }
    }
    
    function editSchedule(){
        showEditSchedule();
    }
    
    function changeRunMode(){
        hideSettingConfig();
        showEditSchedule();
    }
    
    function clearCascadeDeleteSettings(){
        cleanBackupController();
        hideChildBackupModal();
    }

    </script> 
    
<body>   
<apex:form id="theForm">
    <!-- Setting Action Function -->
    <apex:actionFunction name="saveSetting" action="{!saveNewSetting}" reRender="infoPanel, allSettings, newSettingFields, editSettingFields, criterionModal, newAndRunButtons, msgs, manualRunComponent, backupSettingFields, backupDownloadConfig" status="loading" onComplete="selectSetting('{!selectedSetting.Id}', {!dupeSettingName}, 'New');"/>
    <apex:actionFunction name="selectSettingAction" action="{!updateSelectedSetting}" rerender="infoPanel, filterLogic, EditCriterionModal, editSettingFields, backupSettingFields, backupDownloadConfig, msgs, cascadeDeleteObjects, deletionWarningMessage, deletionButtons" status="loading">
    <apex:param id="selectedSetting" name="s" value="" assignTo="{!selectedSettingId}"/>
    </apex:actionFunction>
    <apex:actionFunction name="updateSelectedSettingAction" action="{!updateSelectedSetting}" rerender="infoPanel, filterLogic, EditCriterionModal, editSettingFields, criterionModal, backupSettingFields, backupDownloadConfig, cascadeDeleteObjects, deletionWarningMessage, deletionButtons" status="loading" onComplete="processSelectedSetting('{!selectedSettingId}', '', '');">
    <apex:param id="selectedSettingActionId" name="sId" value="" assignTo="{!selectedSettingId}"/>
    </apex:actionFunction>
    <apex:actionFunction name="activate" action="{!activateSelectedSetting}" rerender="infoPanel, allSettings, manualRunComponent" status="loading" onComplete="selectSetting('{!selectedSetting.Id}', '', '');"/>
    <apex:actionFunction name="deleteSeletedSetting" action="{!deleteSetting}" reRender="allSettings, infoPanel, newAndRunButtons, manualRunComponent, criterionModal, backupDownloadConfig, cascadeDeleteObjects" status="loading" onComplete="selectSetting('{!selectedSetting.Id}', '', '');"/>
    <apex:actionFunction name="editLogic" action="{!editFilterLogic}" reRender="filterLogic" status="loading"/>
    <apex:actionFunction name="updateSettingAction" action="{!updateSetting}" rerender="infoPanel, allSettings, editSettingFields, msgs, manualRunComponent" status="loading" onComplete="selectSetting('{!selectedSetting.Id}', {!dupeSettingName}, 'Edit');"/>
    <apex:actionFunction name="updateListOfChildRecordsToDelete" action="{!updateListOfChildRecordsToDelete}" rerender="none" status="loading">
    <apex:param name="context" value="" assignTo="{!context}"/>
    <apex:param name="childObjectToDelete" value="" assignTo="{!childObjectToDelete}"/>
    </apex:actionFunction>
    <apex:actionFunction name="displayRecordPreview" action="{!reRenderRecordPreview}" rerender="preview" status="loading" oncomplete="showRecordPreview();"/>
    <apex:actionFunction name="cleanBackupController" action="{!clearCascadeBackupController}" rerender="backupChildWarning, cascadeDeleteFields" status="loading" onComplete="showBackupConfig();">
    <apex:param name="blankChildObj" value="" assignTo="{!cascadeDeleteObject}"/>
    </apex:actionFunction>
    <apex:actionFunction name="clearPreviewCount" action="{!clearCurrentRecordCount}" rerender="savingsCalculation"/>
    <apex:actionFunction name="runSettings" action="{!runSelectedSettings}" rerender="allSettings, manualRunComponent, manualRunButton, msgs" status="loading" oncomplete="hideManualRun(); processSelectedSetting('{!selectedSettingId}', false, '');"/> 
    
    <!-- Criterion Action Functions -->
    <apex:actionFunction name="selectCriterionAction" action="{!updateSelectedCriterion}" rerender="EditCriterionModal, editCriterionButtons, msg" oncomplete="setFildSelectListSize('edit', {!ParentFieldListForEditCriterion.size});" status="loading">
      <apex:param id="selectedCriterion" name="c" value="" assignTo="{!selectedCriterionId}"/>
    </apex:actionFunction>
    <apex:actionFunction name="addSettingCriteria" action="{!saveNewCriterion}" reRender="criterionModal, editCriterionModal, criteriaPanel, changeLogicButton, msgs" oncomplete="showAdditionalCriterionModal('{!invalidFilterCriteriaMessage}');" status="loading"/>
    <apex:actionFunction name="saveCriteria" action="{!saveNewCriterion}" reRender="criterionModal, editCriterionModal, criteriaPanel, changeLogicButton, srjConfigButtons, msgs"  oncomplete="hideNewCriterionAfterSave('{!invalidFilterCriteriaMessage}', {!!selectedSetting.SH2__Active__c}, {!displayBackupConfig});" status="loading"/>
    <apex:actionFunction name="updateCriteria" action="{!saveNewCriterion}" reRender="criterionModal, editCriterionModal, criteriaPanel, changeLogicButton, msgs" oncomplete="hideEditCriterionAfterSave('{!JSENCODE(invalidFilterCriteriaMessage)}');" status="loading"/>
    <apex:actionFunction name="deleteCriterionAction" action="{!deleteCriterion}" rerender="criteriaPanel, changeLogicButton, msg" status="loading">
    <apex:param id="selectedCriterionToDelete" name="d" value="" assignTo="{!selectedCriterionId}"/>
    </apex:actionFunction>
    <apex:actionFunction name="clearSelectedCriterion" action="{!clearSettingCriterion}" rerender="selectedCriterion, objFields, EditCriterionModal, criterionModal, newSettingFields" status="loading"/>
    <apex:actionFunction name="addCriterion" action="{!clearCriterion}" rerender="criterionModal" status="loading"/>
    <apex:actionFunction name="shouldNotShowBackupConfig" action="{!dontDisplayBackupConfig}" rerender="none"/>
    
    <!-- Config Action Functions -->
    <apex:actionFunction name="settingConfigUpdate" action="{!updateSettingConfig}" rerender="settingConfig, dataUsage, msgs, runJobPopover, dataExportError, activationNotification" status="loading"/>
        
    <!-- Scheduled Run Functions -->
    <apex:actionFunction name="scheduleUpdate" action="{!updateSettingConfig}" rerender="settingConfig, dataUsage, msgs, runJobPopover, currentRunMode, scheduleInputs" oncomplete="hideEditSchedule('{!invalidSchedule}');" status="loading"/>
    
    <apex:actionStatus id="loading" onstart="loading(true)" onstop="loading(false)" />
    
      <!-- REQUIRED SLDS WRAPPER -->
      <div class="slds">   
        <!-- PAGE HEADER -->
        <div class="slds-page-header" role="banner">
          <div class="slds-grid">
            <div class="slds-col">
              <apex:outputPanel id="runJobPopover">
                  <apex:outputPanel rendered="{!RunJobOff}">
                    <div class="slds-popover slds-nubbin--bottom-right slds-theme--info" role="dialog">
                      <div class="slds-popover__body">
                        Storage Helper has not been configured to run Automatically. If you would like Storage Helper to run automatically please click the gear icon below, then click the 'Change Run Mode' button.
                      </div>
                    </div>
                    <br/>
                  </apex:outputPanel>
              </apex:outputPanel>
            </div>
          </div>
          
          <div class="slds-grid">
            
            <div class="slds-col">
              <span>
              <h1 class="slds-text-heading--medium">All Storage Recycle Jobs&nbsp;&nbsp;</h1>
                <a href="javascript:void(0);" class="slds-button slds-button--icon-border-filled slds-button--icon-small" onClick="showSettingConfig();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/settings_60.png')}"/>
                  <span class="slds-assistive-text">Settings</span>
                </a>
                <apex:commandButton styleClass="slds-button slds-button--neutral" onclick="showHelpScreen();" value="FAQ" rerender="none"/>
              </span>
            </div>
        
            <div class="slds-col slds-no-flex slds-align-middle">
         
              <div class="slds-button-group" role="group">
                <apex:outputPanel id="newAndRunButtons">
                <apex:outputPanel id="newButton" rendered="{!settingObjAccessible}">  
                    <button type="button" class="slds-button slds-button--neutral" onclick="newSetting();" autocomplete="off">
                      New Storage Recycle Job
                    </button>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!AND(nfpController.isNonprofit, NOT(IsPayingCustomer))}">
                    <button type="button" class="slds-button slds-button--neutral" onclick="openCouponCodeModal();">
                      Get Nonprofit Coupon Code 
                    </button>
                </apex:outputPanel>
                <apex:outputPanel id="runButton" rendered="{!AND(IF(numberOfSettings == 0, false, true), HasNotHitLimit)}">
                    <apex:commandButton value="Run" styleclass="slds-button slds-button--neutral" onclick="showManualRun();" reRender="none"/>
                </apex:outputPanel>
                </apex:outputPanel>
              </div>
         
            </div>
         
          </div>
         
        </div>
        <!-- / PAGE HEADER --> 
      
        <div class="slds-grid">
<!-- Settings Table -->   
        <div class="slds-col slds-col-rule--right slds-p-right--large slds-small-size--1-of-2 slds-medium-size--3-of-5 slds--large-size--8-of-12">
         <apex:pageMessages id="msgs" />
          <div class="slds-card">
            <section class="slds-card__body">
              <div class="slds-scrollable--x">
                <apex:outputPanel id="allSettings">
                  
                <apex:outputPanel id="freeWarning" rendered="{!!HasNotHitLimit}">
                  <center>
                  <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px">
                    <center>
                    <b>You have deleted more than 20,000 records this month. To delete more records monthly the premium version is required.&nbsp;<apex:outputLink style="color:blue" target="_blank" value="http://www.passagetechnology.com/helper-suite-order">Click here to purchase the premium version.</apex:outputLink></b>
                    </center>
                  </div>
                  </center>
                </apex:outputPanel>
                
                <apex:outputPanel id="settingTable" rendered="{!IF(numberOfSettings > 0, true, false)}">
                <table class="slds-table slds-table--bordered slds-max-medium-table--stacked-horizontal">
                  <thead>
                    <tr class="slds-no-hover">
                      <th class="slds-text-heading--label slds-size--6-of-8" scope="col">Name</th>
                      <th class="slds-text-heading--label slds-size--1-of-8" scope="col"><center>Status</center></th>
                      <th class="slds-text-heading--label slds-size--1-of-8" scope="col"><center>Active</center></th>
                    </tr>
                  </thead>
                  <tbody>
                    <apex:repeat value="{!settings}" var="s">
                      <tr class="slds-hint-parent" id="s_{!s.Id}" onclick="updateSelectedSettingAction('{!s.Id}');">
                          <td class="slds-size--6-of-8" data-label="Name"><apex:outputText value="{!s.Name}"/></td>
                          <td class="slds-size--1-of-8" data-label="Status">
                            <center>
                            <apex:outputPanel id="statusColumn">
                            <apex:outputPanel rendered="{!IF(s.SH2__Status__c == 'Running', true, false)}"><img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/rotate_60.png')}" title="Running"/></apex:outputPanel>
                            <apex:outputPanel rendered="{!IF(OR(s.SH2__Status__c == 'Running', s.SH2__Status__c == 'Error'), false, true)}"><img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/like_60.png')}" title="Ready"/></apex:outputPanel>
                            <apex:outputPanel rendered="{!IF(s.SH2__Status__c == 'Error', true, false)}"><img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/error_60.png')}" title="Error"/></apex:outputPanel>
                            </apex:outputPanel>
                            </center>
                          </td>
                          <td class="slds-size--1-of-8" data-label="Active"><center><apex:outputPanel rendered="{!s.SH2__Active__c}"><img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/check_60.png')}"></img></apex:outputPanel></center></td>
                      </tr>
                       
                      <script>
                          if('{!s.Id}' == '{!selectedSettingId}'){
                            document.getElementById('s_' + '{!s.Id}').className += ' slds-is-selected';
                            document.getElementById('s_' + '{!s.Id}').removeAttribute("onclick");
                          }
                      </script>
                    
                    </apex:repeat>
                  </tbody>
         
                </table>
                </apex:outputPanel>
                <apex:actionPoller reRender="statusColumn" interval="20"/>
                
                <apex:outputPanel id="noSettingMessage" rendered="{!IF(numberOfSettings == 0, true, false)}">
                    <center>
                    No Storage Recycle Jobs exist. You may create a new setting by clicking the 'New Storage Recycle Job' button.
                    </center>
                </apex:outputPanel>
                </apex:outputPanel>
              </div>
            </section>
          </div>

          <br/><br/><br/><br/>
          <center>
          <apex:outputPanel id="dataUsage">
          <div class="slds-card" style="width:80%">
            <center>
            <apex:commandLink value="{!CurrentRunMode}" onclick="changeRunMode();" rerender="none"/>
            <br/><br/>
            <div id="storageCalcHelp" style="display:none">
              <div class="slds-popover slds-popover--tooltip slds-nubbin--bottom" role="tooltip" aria-live="polite">
                <div class="slds-popover__body slds-text-longform">
                  <p>The storage calculation displayed below may not be exactly the same as Salesforce's storage usage page. We calculate the storage usage percentage only once an hour.</p>
                  <apex:commandButton styleclass="slds-button slds-button--neutral" action="{!createDataCalculator}" value="Recalculate Data Usage Percentage" reRender="dataUsage" status="loading"/>
                </div>
              </div>
              <br/>
            </div>
            <c:DSH_DataUsage id="dataUsageComponent"/>
            </center>
          </div>
          </apex:outputPanel>
          </center>
          <apex:actionPoller reRender="dataUsageComponent" interval="33"/>
         
        </div>
<!-- / Settings Table -->
        <div id="rightPanel" class="column region-sidebar slds-small-size--1-of-2 slds-medium-size--2-of-5 slds-large-size--3-of-12" style="background:#f4f6f9;">
        <apex:outputPanel id="infoPanel">
        <apex:outputPanel rendered="{!IF(settings.size > 0, true, false)}" styleClass="slds-col slds-p-left--large slds-small-size--1-of-2 slds-medium-size--2-of-5 slds-large-size--3-of-12">
          <div class="slds-tabs--scoped">
              <ul class="slds-tabs--scoped__nav" role="tablist">
                <li id="infoTab" class="slds-tabs--scoped__item slds-text-heading--label slds-active" title="Setting Information" role="presentation"><a class="slds-tabs--scoped__link" role="tab" tabindex="0" aria-selected="true" onclick='showSettingInfo();'>Detail</a></li>
                <li id="criteriaTab" class="slds-tabs--scoped__item slds-text-heading--label" title="Criterion" role="presentation"><a class="slds-tabs--scoped__link" role="tab" tabindex="-1" aria-selected="false" onclick='showCriterion();'>Filters</a></li>
                <li id="backupTab" class="slds-tabs--scoped__item slds-text-heading--label" title="Backup" role="presentation"><a class="slds-tabs--scoped__link" role="tab" tabindex="-1" aria-selected="false" onclick='showBackup();'>Backup</a></li>
              </ul>

<!-- Setting Info -->
                <div class="slds-card" style="background:White" id="settingInfo">
         
                    <section class="slds-card__body">
                    
                    <div class="slds-page-header" style="background:White" role="banner">
                     
                        <div class="slds-col" style="overflow:hidden">
                           <h2 class="slds-text-heading--medium slds-truncate">{!selectedSetting.Name}</h2><br/>
                        </div>
                        
                      <div class="slds-grid">
                     
                        <div class="slds-col slds-no-flex slds-align-middle">
                     
                          <div class="slds-button-group" role="group">
                          <apex:outputPanel rendered="{!ObjectExists}">
                            <button type="button" class="slds-button slds-button--neutral" onClick="showSettingEdit('{!selectedSetting.Id}');">
                              Edit
                            </button>
                            <button type="button" class="slds-button slds-button--neutral" onClick="deleteSettingButton();">
                              Delete
                            </button>
                            <button type="button" class="slds-button slds-button--neutral" onClick="previewRecords();">
                              Preview Records
                            </button>
                          </apex:outputPanel>
                          
                          <apex:outputPanel rendered="{!!ObjectExists}">
                            <button type="button" class="slds-button slds-button--neutral" onClick="deleteSettingButton();">
                              Delete
                            </button>
                          </apex:outputPanel>
                          </div>
                     
                        </div>
                     
                      </div>
                     
                    </div>
                    
                      <ul>
                        <li class="slds-tile slds-hint-parent">

                          <apex:outputPanel id="settingInfoPanel">
                          <center>
                            <apex:outputPanel rendered="{!!ObjectExists}">
                              <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px">
                                <center>
                                The object that this Storage Recycle Job was created for no longer exists.
                                </center>
                              </div>
                            </apex:outputPanel>
                          <div class="slds-small-size--6-of-7 slds-medium-size--4-of-5 slds-large-size--3-of-5">
                          <div class="tile__detail" align="left">
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Active:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                <p class="slds-truncate"><apex:inputCheckbox value="{!selectedSetting.SH2__Active__c}" disabled="true" title="Click the 'Edit' button to activate."/></p>
                              </dd>
                            </dl>
                            
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Object:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                <p class="slds-truncate">{!selectedSetting.SH2__Object__c}</p>
                              </dd>
                            </dl>
                            
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Total Savings:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                <p>Yearly Savings: {!currencySymbol}{!totalSRJSavings}
                                   <br/>
                                   Records Recycled: {!TotalRecordsRecycled}</p>
                              </dd>
                            </dl>
                            
                            <apex:outputPanel rendered="{!IF(recentRunDateTime != null, true, false)}">
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Most Recent Run Information:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                <p>{!recentRunDateTime}<br/>
                                   {!NumberOfRecentRecordsRecycled}</p>
                              </dd>
                            </dl>
                            </apex:outputPanel>
                              
                            <apex:outputPanel rendered="{!IF(ChildObjectsSelected != null, true, false)}">
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Child Objects Recycled:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                <p>{!ChildObjectsSelected}</p>
                              </dd>
                            </dl>
                            </apex:outputPanel>

                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Hard Delete Records:
                              </dt>
                              <dd>
                                <p class="slds-truncate"><apex:inputCheckbox value="{!selectedSetting.SH2__Hard_Delete__c}" disabled="true" title="Click the 'Edit' button to modify."/></p>
                              </dd>
                            </dl>

                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Created By:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                <p>{!selectedSetting.createdBy.Name}</p>
                              </dd>
                            </dl>

                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Last Modified:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                <p>{!selectedSetting.lastModifiedBy.Name}</p>
                                <p>{!lastModifiedDate}</p>
                              </dd>
                            </dl>
                            
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Notes:
                              </dt>
                              <dd>
                                <div class="slds-scrollable--y" style="height:90px;">{!selectedSetting.SH2__Notes__c}</div>
                              </dd>
                            </dl>
                          </div>  
                          </div>
                          </center>
                          </apex:outputPanel>
                          <br/>
                        </li>
                      </ul>
                    </section>
                 
                  </div>
<!-- / Setting Info -->               
                  
<!-- Criterion -->
                <div class="slds-card" style="background:White; margin-top: 0px; display:none" id="criterion">
             
                        <section class="slds-card__body">
                        <apex:outputPanel id="criteriaPanel">
                        <div class="slds-page-header" style="background:White" role="banner">

                        <div class="slds-col" style="overflow:hidden">
                           <h2 class="slds-text-heading--medium slds-truncate">{!selectedSetting.Name}</h2><br/>
                        </div>
                        
                        <div class="slds-grid">
                        
                        <div class="slds-col slds-no-flex slds-align-middle">
                         
                              <div class="slds-button-group" role="group">
                                <apex:outputPanel rendered="{!ObjectExists}">
                                  <button type="button" class="slds-button slds-button--neutral" onclick="addAdditionalCriteria();">
                                    Add Filter
                                  </button>
                                  <apex:outputPanel id="changeLogicButton" rendered="{!IF(selectedCriteria.size > 1, true, false)}">
                                  <div class="slds-dropdown-trigger">
                                    <button type="button" class="slds-button slds-button--icon-border-filled" aria-haspopup="true">                     
                                      <apex:image url="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/down_60.png')}" height="60%" width="60%"/>
                                    </button>
                                      <div class="slds-dropdown slds-dropdown--right slds-dropdown--menu">
                                        <ul class="slds-dropdown__list" role="menu">
                                          <li class="slds-dropdown__item">
                                            <a href="javascript:void(0)" role="menuitem" onClick="updateFilterLogic();">
                                             Change Filter Logic
                                            </a>
                                          </li>
                                        </ul>
                                      </div>
                                  </div>
                                  </apex:outputPanel>
                                </apex:outputPanel>
                              </div>
                         
                            </div>
                         
                          </div>
                          </div>
                        
                          <apex:outputPanel rendered="{!!ObjectExists}">
                            <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px">
                              <center>
                              The object that this Storage Recycle Job was created for no longer exists.
                              </center>
                            </div>
                          </apex:outputPanel>
                        
                          <ul>
                            <li class="slds-tile slds-hint-parent">
                              <center>
                              <div>
                              <apex:outputPanel id="allCriterion" rendered="{! IF(selectedCriteria.size > 0, true, false)}">
                              <div style="overflow: auto; max-height:400px">
                              <apex:pageBlock >
                              <apex:pageBlockTable value="{!selectedCriteria}" styleClass="slds-table slds-table--bordered" var="c">
                              <apex:column styleClass="slds-size--5-of-7">
                              <b>Order:&nbsp;</b><apex:outputText value="{!c.id + 1}"/>
                              <span style="float:right">
                                <a href="javascript:void(0)" role="menuitem" onclick="editCriterion('{!c.Id}')">
                                  Edit
                                </a>
                                |
                                <a href="javascript:void(0)" role="menuitem" onclick="deleteSelectedCriterion('{!c.Id}')">
                                  Delete
                                </a>
                              </span><br/>
                              
                              <p Class="slds-truncate" title="{!c.Field}"><b>Field:&nbsp;</b>{!c.Field}</p>
                              <b>Operator:&nbsp;</b> <apex:outputText value="{!c.logic}"/> <br/>
                              <p Class="slds-truncate" title="{!c.condition}"><b>Value:&nbsp;</b>{!c.condition}</p>
                              </apex:column>
                            
                              </apex:pageBlockTable>
                              </apex:pageBlock>
                              </div>
                              
                              <br/>
                              <apex:outputPanel id="filterLogic" rendered="{! IF(selectedCriteria.size > 1, true, false)}">
                              <apex:outputText value="{!invalidMessage}" style="color:red;" rendered="{!showInvalidBoolString}" id="boolStringError" /><br/>
                              <b>Filter Logic:</b> 
                              <span>
                                <apex:inputText value="{!selectedSetting.SH2__Filter_Logic__c}" disabled="{!NOT(editLogicContext)}"/><br/>
                              </span>
                              <apex:commandButton value="Update" action="{!updateFilterLogic}" rendered="{!editLogicContext}" reRender="filterLogic, filterString" status="loading"/>
                              </apex:outputPanel>
                              <br/><br/>
                              <div>
                              <b>Filter String:</b>
                              <br/>
                              <div style="max-height:200px; overflow: scroll;"><apex:outputText id="filterString" value="{!filterLogic}" rendered="{!NOT(filterLogic == null)}"/></div>
                              </div>
                              </apex:outputPanel>
                              </div>
                              </center>
                            </li>
                          </ul>
                        </apex:outputPanel>
                        </section>
                     
                      </div>
<!-- / Criterion -->

<!-- Backup Info -->
              <div class="slds-card" style="background:White; margin-top: 0px; display:none" id="backupSettings">
             
                    <section class="slds-card__body">
                    <apex:outputPanel id="backupPanel">
                    <div class="slds-page-header" style="background:White" role="banner">
      
                    <div class="slds-col" style="overflow:hidden">
                       <h2 class="slds-text-heading--medium slds-truncate">{!selectedSetting.Name}</h2><br/>
                    </div>
                    
                      <div class="slds-grid">
                      
                        <div class="slds-col slds-no-flex slds-align-middle">
                         
                          <div class="slds-button-group" role="group">
                            <apex:outputPanel >
                              <apex:commandButton value="Backup Settings" action="{!editBackupConfig}" styleClass="slds-button slds-button--neutral" rerender="fieldBackupSelect, srjConfigButtons" status="loading" onComplete="showBackupConfig();"/>
                              <apex:commandButton value="View Backup Files" action="{!buildBackupPaginationController}" styleClass="slds-button slds-button--neutral" status="loading" rerender="backupDownloadConfig" onComplete="showBackupDownload();"/>
                            </apex:outputPanel>
                          </div>
                          
                        </div>
                       
                      </div>
                    </div>
                    
                    <ul>
                        <li class="slds-tile slds-hint-parent">

                          <apex:outputPanel id="backupInfoPanel">
                          <center>
                          <div class="slds-small-size--6-of-7 slds-medium-size--4-of-5 slds-large-size--3-of-5">
                          <div class="tile__detail" align="left">
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Backup Mode:
                              </dt>
                              <dd class="slds-dl--horizontal__detail slds-tile__meta">
                                {!selectedSetting.SH2__Backup_Mode__c}
                              </dd>
                            </dl>
                            
                            <apex:outputPanel rendered="{!selectedSetting.SH2__Backup_Mode__c == 'Select Fields To Backup'}">
                            <dl class="dl--horizontal slds-text-body--small slds-has-divider--top-space">
                              <dt>
                                Fields To Backup:
                              </dt>
                              <dd>
                                <apex:outputText escape="false" value="{!AllFieldsToBackup}"/>
                              </dd>
                            </dl>
                            </apex:outputPanel>
                            
                          </div>  
                          </div>
                          </center>
                          </apex:outputPanel>
                        </li>   
                    </ul>
                    
                    </apex:outputPanel>
                    </section>
              </div>
<!-- / Backup Info -->
              
          </div>
        </apex:outputPanel>
        </apex:outputPanel>  
        </div>

        </div>
        
<!-- Record Preview -->     
        <div id="recordPreview" style="display:none;">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container" style="min-width:450px">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Recyclable Records</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="clearPreviewCount();hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
                <apex:outputPanel id="preview">
                  <apex:outputPanel rendered="{!DeletionErrorMessage != null}" style="color:red"><apex:outputText value="{!DeletionErrorMessage}" style="color:red;"/></apex:outputPanel>
                  <c:DSH_RecordPreview setting="{!selectedSetting}" hasOwnerFld="{!hasOwnerField}" pageController="{!previewController}" rendered="{!renderRecordPreview}"/>
                </apex:outputPanel>
              </div>
            </div>
          </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / Record Preview -->
        
<!-- Setting Config -->
        <div id="settingConfig" style="display:none;">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Storage Helper Settings</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
                    Maximum Number of Records to Recycle: 
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#limitInfo').toggle();" onmouseout="dsh.j$('#limitInfo').toggle();"/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="limitInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">This is the maximum number of records Storage Helper will recycle in a single run context.
                              </div>
                            </div>
                        </div>
                    <apex:inputField id="maxRecordsToDelete" styleClass="slds-input" value="{!settingConfig.SH2__Max_Records_To_Delete__c}"/>
                    <div id="maxRecordsError" style="display:none;"><font style="color:red">The max value for this field is 50,000.</font></div><br/>
                    Alert Threshold (in Percent): 
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#thresholdInfo').toggle();" onmouseout="dsh.j$('#thresholdInfo').toggle();"/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="thresholdInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">A storage usage alert will be sent when the usage reaches this percentage.
                              </div>
                            </div>
                        </div>
                    <apex:inputText styleClass="slds-input" value="{!settingConfig.SH2__Alert_Threshold__c}"/><br/>
                    Notification Email Address(es):
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#emailInfo').toggle();" onmouseout="dsh.j$('#emailInfo').toggle();"/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="emailInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">Email addresses that will be sent usage alerts. Multiple email addresses may be seperated by a comma EX: test@email.com,email@test.com.
                              </div>
                            </div>
                        </div>
                    <apex:inputText styleClass="slds-input" id="emailAddress" value="{!settingConfig.SH2__Alert_Emails__c}"/>
                    <div id="emailError" style="display:none;"><font style="color:red">This is not a valid email address.</font></div><br/>
                    Force Record Preview for New Storage Recycle Jobs:
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" title="With this setting enabled, a preview of records that a new Storage Recycle Job will delete will be displayed before activation. This will help ensure that the filters defined are correct before the Storage Recycle Job is activated."/><br/>
                    <apex:inputCheckbox style="height:17px;width:17px;" value="{!settingConfig.SH2__Force_Preview__c}"/><br/>
                    Salesforce Data Storage is Purchased at a Discount:
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#discountInfo').toggle();" onmouseout="dsh.j$('#discountInfo').toggle();"/><br/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="discountInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">If your organization purchases data storage at a discount this box should be checked.
                              </div>
                            </div>
                        </div>
                    <apex:inputCheckbox style="height:17px;width:17px;" value="{!storageDiscount}"><apex:actionSupport event="onchange" rerender="discountInput" status="loading"/></apex:inputCheckbox><br/>
                    <apex:outputPanel id="discountInput">
                      <apex:outputPanel rendered="{!storageDiscount}">
                      Salesforce Data Storage Cost (Per 500MB/year):<apex:inputField styleClass="slds-input" value="{!settingConfig.SH2__Data_Storage_Cost__c}"/><br/>
                      </apex:outputPanel>
                    </apex:outputPanel>
                    Auto Delete Old Storage Helper Backups:
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#autoCleanupInfo').toggle();" onmouseout="dsh.j$('#autoCleanupInfo').toggle();"/><br/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="autoCleanupInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">With this setting checked you may specify how long to keep the backups that Storage Helper generates.
                              </div>
                            </div>
                        </div>
                    <apex:inputCheckbox value="{!autoDeleteBackups}" style="height:17px;width:17px;">
                    <apex:actionSupport event="onchange" reRender="backupLength" status="loading"/>
                    </apex:inputCheckbox><br/>
                    <apex:outputPanel id="backupLength">
                        <apex:outputPanel rendered="{!autoDeleteBackups}">
                            Number of Months to Keep Backups:<br/>
                            <apex:inputText styleClass="slds-input" value="{!settingConfig.SH2__Months_To_Keep_Backups__c}"/>
                            <br/>
                        </apex:outputPanel>
                    </apex:outputPanel> 
                    Track Monthly Data and File Storage:
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#trackTotalsInfo').toggle();" onmouseout="dsh.j$('#trackTotalsInfo').toggle();"/><br/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="trackTotalsInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">With this setting checked two Storage Usage Tracking records will be created each month to track storage usage.
                              </div>
                            </div>
                        </div>
                    <apex:inputCheckbox style="height:17px;width:17px;" value="{!settingConfig.SH2__Track_Storage_Usage__c}"/>
                    <br/>
                    Track Monthly Object Storage Usage:
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#trackObjectInfo').toggle();" onmouseout="dsh.j$('#trackObjectInfo').toggle();"/><br/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="trackObjectInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">With this setting checked a Storage Usage Tracking record will be created each month for every object in your environment. Please Note: this will consume data storage.
                              </div>
                            </div>
                        </div>
                    <apex:inputCheckbox style="height:17px;width:17px;" value="{!settingConfig.SH2__Track_Object_Usage__c}"/>
                    <br/>
                    <br/>
                    <center>
                    <apex:outputText value="{!CurrentRunMode}" id="currentRunMode"/><br/>
                    <button type="button" class="slds-button slds-button--neutral" onclick="changeRunMode();">Change Run Mode</button>
                    </center>
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <button type="button" class="slds-button slds-button--neutral" onClick="hideAllModals();">Cancel</button>
                  <button type="button" class="slds-button slds-button--neutral" onclick="saveSettingConfig();">Save</button>
                </div>
              </div>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / Setting Config -->       
        
<!-- New Setting -->
        <div id="newSetting" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container" style="max-width:800px;">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">New Storage Recycle Job</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
              <apex:outputPanel id="newSettingFields">
                <apex:outputPanel id="notUndeletable">
                  <apex:outputPanel rendered="{!!IsUndeletable}">
                  <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px" role="alert">
                    <b>Please Note: The records for this object type will not be sent to the recycling bin when this Storage Recycle Job is run. Please ensure backups are in place for this object type.</b>
                  </div>
                  </apex:outputPanel>
                </apex:outputPanel>
                <div class="slds-grid">
                    <div class="slds-size--1-of-1">
                        Name:
                        <br/>
                            <apex:inputText styleClass="slds-input" id="settingName" maxlength="80" value="{!newSetting.Name}"/>
                            <div id="newSettingNameError" style="display:none;"><font style="color:red">A Storage Recycle Job already exists with this name.</font></div>
                    </div>
                </div>
                <div class="slds-grid">
                  <div class="slds-size--1-of-1">
                   <apex:outputPanel id="newObjects">
                      <p style="float:left;">Object:</p> 
                      <p style="float:right;"><c:Paginate pageController="{!newObjectsController}" renderedComponent="newObjects" statusDisplay="loading"/></p>
                      <apex:selectList styleClass="slds-select .is-required" id="objectList" size="4" value="{!newSetting.SH2__Object__c}">
                      <apex:actionSupport event="onchange" rerender="dependentChildrenTableNew, notUndeletable" status="loading"/>  
                      <apex:selectOptions value="{!newPaginatedObjectList}"/></apex:selectList>
                   </apex:outputPanel> 
                   <div id="NewSettingObjectError" style="display:none;"><font style="color:red">This is a required Field.</font></div>       
                  </div>
               </div>
               <div class="slds-grid">
                    <div class="slds-size--1-of-1">
                        Notes:
                        <br/>
                            <apex:inputTextArea styleClass="slds-textarea" id="settingNotes" value="{!newSetting.SH2__Notes__c}"/>
                    </div>
                </div>
                <div class="slds-grid">
                    <div class="slds-size--1-of-1">
                        Hard Delete Records:
                        <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#hardDeleteInfo').toggle();" onmouseout="dsh.j$('#hardDeleteInfo').toggle();"/><br/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="hardDeleteInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none;max-width:500px;">
                              <div class="slds-popover__body">With this setting checked, records will NOT be sent to the recycling bin.
                              </div>
                            </div>
                        </div>
                        <apex:inputCheckbox value="{!newSetting.SH2__Hard_Delete__c}" style="height:17px;width:17px;"/>
                    </div>    
                </div>
                <apex:outputPanel id="dependentChildrenTableNew">
                <apex:outputPanel rendered="{!ListOfChildObjectForNewSRJ.size > 0}">
                    <br/>
                    <div class="slds-notify_container">
                      <div class="slds-notify slds-notify--alert slds-theme--alert-texture" role="alert">
                        <div class="slds-text-longform">
                        <span class="slds-assistive-text">Required Cascade Deletion Objects</span>
                        <b>
                        <h2>Below is a list of child objects that could block {!newSetting.SH2__Object__c} records from being recycled.<br/>
                        Select the child object type(s) you would like to recycle with their parents.</h2>
                        </b>
                        <div align="left">
                        <ul>
                          <li>If no child object types are checked, only {!newSetting.SH2__Object__c} records that do not have child records that belong to the object type(s) listed below will be recycled.</li>
                          <li>Child records of the object type(s) listed below cannot be restored from the recycling bin. Please ensure backups are in place for these objects.</li>
                        </ul>
                        </div>
                        </div>
                      </div>
                    </div>
                    <div class="slds-scrollable--x">
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                    <thead>
                      <tr>
                        <th scope="col" style="width:30px;">
                          <div class="slds-truncate" title="Cascade Delete">Cascade Delete</div>
                        </th>
                        <th scope="col">
                          <div class="slds-truncate" title="Child Object Type">Child Object Type</div>
                        </th>
                        <th scope="col">
                          <div class="slds-truncate" title="Lookup Field">Lookup Field</div>
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                     
                    <apex:repeat value="{!ListOfChildObjectForNewSRJ}" var="obj">
                      <tr>
                        <th scope="row" data-label="Cascade Delete" style="width:30px;">
                          <center>
                          <apex:inputCheckbox value="{!obj.selected}" onclick="updateListOfChildRecordsToDelete('new', '{!obj.identifier}');"/>
                          </center>
                        </th>
                        <th scope="row" data-label="Child Object Type">
                          {!obj.objLabel}
                        </th>
                        <th scope="row" data-label="Lookup Field">
                          {!obj.lookupField}
                        </th>
                      </tr>
                    </apex:repeat>
                 
                    </tbody>
                    </table>
                    </div>
                </apex:outputPanel>
                </apex:outputPanel>
               </apex:outputPanel>
                
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <button type="button" class="slds-button slds-button--neutral" onClick="hideAllModals();">Cancel</button>
                  <button type="button" onclick ="newSettingFilter();" class="slds-button slds-button--neutral">Next</button>
                </div>
              </div>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / New Setting -->
        
<!-- Edit Setting -->
        <div id="editSetting" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container" style="max-width:800px;">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Edit Storage Recycle Job</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
              <apex:outputPanel id="editSettingFields">
                <apex:outputPanel id="activeWarning2">
                <apex:outputPanel rendered="{!selectedSetting.SH2__Active__c}">
                  <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px" role="alert">
                    <b>Please Note: To prevent important data from being deleted accidentally, we recommend keeping the Storage Recycle Job inactive until the deletion filters are fully defined.</b>
                  </div>
                </apex:outputPanel>
                </apex:outputPanel>
                <div class="slds-grid">
                    <div class="slds-size--1-of-1">
                        Name:
                        <br/>
                            <apex:inputText styleClass="slds-input" maxlength="80" value="{!selectedSetting.Name}"/>
                            <div id="editSettingNameError" style="display:none;"><font style="color:red">A Storage Recycle Job already exists with this name.</font></div>
                    </div>
                </div>
                <div class="slds-grid">
                    <div class="slds-size--1-of-1">        
                      <apex:outputPanel id="editObjects">
                        <p style="float:left;">Object:</p> 
                        <p style="float:right;"><c:Paginate pageController="{!editObjectsController}" renderedComponent="editObjects" statusDisplay="loading"/></p>
                        <apex:selectList styleClass="slds-select .is-required" id="editObjectList" size="4" value="{!selectedSetting.SH2__Object__c}">
                          <apex:actionSupport event="onchange" rerender="dependentChildrenTableEdit" status="loading"/>  
                        <apex:selectOptions value="{!editPaginatedObjectList}"/></apex:selectList>
                      </apex:outputPanel>
                      <div id="EditSettingObjectError" style="display:none;"><font style="color:red">This is a required Field.</font></div>
                    </div>
                </div>
                <div class="slds-grid">
                    <div class="slds-size--1-of-1">
                        Notes:
                        <br/>
                            <apex:inputTextArea styleClass="slds-textarea" value="{!selectedSetting.SH2__Notes__c}"/>
                    </div>
                </div>
                <div class="slds-grid">
                    <div class="slds-size--1-of-1">
                        Hard Delete Records:
                        <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#hardDeleteEditInfo').toggle();" onmouseout="dsh.j$('#hardDeleteEditInfo').toggle();"/><br/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="hardDeleteEditInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none;max-width:500px;">
                              <div class="slds-popover__body">With this setting checked, records will NOT be sent to the recycling bin.
                              </div>
                            </div>
                        </div>
                        <apex:inputCheckbox style="height:17px;width:17px;" value="{!selectedSetting.SH2__Hard_Delete__c}"/>
                    </div>    
                </div>
                <div class="slds-grid">
                    <div class="slds-size--1-of-1">
                        Active:
                        <br/>
                            <apex:inputCheckbox style="height:17px;width:17px;" value="{!selectedSetting.SH2__Active__c}">
                              <apex:actionSupport event="onchange" rerender="activeWarning2" status="loading"/>
                            </apex:inputCheckbox>
                    </div>
                </div>
                
                
                <apex:outputPanel id="dependentChildrenTableEdit">
                <apex:outputPanel rendered="{!ListOfChildObjectForEditSRJ.size > 0}">
                    <br/>
                    <div class="slds-notify_container">
                      <div class="slds-notify slds-notify--alert slds-theme--alert-texture" role="alert">
                        <div class="slds-text-longform">
                        <span class="slds-assistive-text">Required Cascade Deletion Objects</span>
                        <b>
                        <h2>Below is a list of child objects that could block {!selectedSetting.SH2__Object__c} records from being recycled.<br/>
                        Select the child object type(s) you would like to recycle with their parents.</h2>
                        </b>
                        <div align="left">
                        <ul>
                          <li>If no child object types are checked, only {!selectedSetting.SH2__Object__c} records that do not have child records that belong to the object type(s) listed below will be recycled.</li>
                          <li>Child records of the object type(s) listed below cannot be restored from the recycling bin. Please ensure backups are in place for these objects.</li>
                        </ul>
                        </div>
                        </div>
                      </div>
                    </div>
                    <div class="slds-scrollable--x">
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                    <thead>
                      <tr>
                        <th scope="col" style="width:30px;">
                          <div class="slds-truncate" title="Cascade Delete">Cascade Delete</div>
                        </th>
                        <th scope="col">
                          <div class="slds-truncate" title="Child Object Type">Child Object Type</div>
                        </th>
                        <th scope="col">
                          <div class="slds-truncate" title="Lookup Field">Lookup Field</div>
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                     
                    <apex:repeat value="{!ListOfChildObjectForEditSRJ}" var="obj">
                      <tr>
                        <th scope="row" data-label="Cascade Delete" style="width:30px;">
                          <center>
                          <apex:inputCheckbox value="{!obj.selected}" onclick="updateListOfChildRecordsToDelete('edit', '{!obj.identifier}');"/>
                          </center>
                        </th>
                        <th scope="row" data-label="Child Object Type">
                          {!obj.objLabel}
                        </th>
                        <th scope="row" data-label="Lookup Field">
                          {!obj.lookupField}
                        </th>
                      </tr>
                    </apex:repeat>
                 
                    </tbody>
                    </table>
                    </div>
                </apex:outputPanel>
                </apex:outputPanel>
                
                
               </apex:outputPanel>
                
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <button type="button" class="slds-button slds-button--neutral" onClick="showCriterion();">Edit Filters</button>
                  <button type="button" class="slds-button slds-button--neutral" onClick="hideAllModals();">Cancel</button>
                  <button type="button" onclick ="updateSetting();" class="slds-button slds-button--neutral">Update</button>
                </div>
              </div>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / Edit Setting -->
        
<!-- New Filter Criteria -->
        <div id="newCriterion" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Create Filter</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <apex:outputPanel id="criterionModal">
              <div class="slds-modal__content">
                <div class="slds-grid slds-wrap">
                      <div id="newFieldSelection" class="slds-size--1-of-1">
                        <apex:outputPanel id="newFields">
                            <p style="float:left;">Field:</p> 
                            <p style="float:right;"><c:Paginate pageController="{!fieldsController}" renderedComponent="newFields" statusDisplay="loading"/></p>
                            <apex:selectList styleClass="slds-select" value="{!newCriterion.Field}" id="objFields" size="4"> 
                            <apex:actionSupport event="onchange" action="{!clearFilterOperator}" rerender="newCritOper, newCritVal, fkObjFields1, newCriteriaInformation" oncomplete="setFildSelectListSize('new', {!parentFieldListForNewCriterion.size});" status="loading">
                              <apex:param assignTo="{!context}" value="target" name="targetFieldContext"/>
                            </apex:actionSupport>
                            <apex:selectOptions value="{!FieldList}"/> 
                            </apex:selectList>
                        </apex:outputPanel>
                      </div>
                      <div id="newFKSelection" class="slds-size--1-of-2">
                        <apex:outputPanel id="fkObjFields1">
                          <apex:outputPanel rendered="{!ParentFieldListForNewCriterion.size > 0}">
                            <p style="float:left;">&nbsp;</p>
                            <p style="float:right;"><c:Paginate pageController="{!parentFieldsController}" renderedComponent="fkObjFields1, newCritOper, msgs" statusDisplay="loading"/></p>
                            <apex:selectList styleClass="slds-select" value="{!parentField}" size="4"> 
                            <apex:actionSupport event="onchange" action="{!clearFilterOperator}" rerender="newCritOper, newCritVal, newCriteriaInformation, msgs" status="loading">
                              <apex:param assignTo="{!context}" value="parent" name="parentFieldContext"/>
                            </apex:actionSupport>
                            <apex:selectOptions value="{!ParentFieldListForNewCriterion}"/> 
                            </apex:selectList>
                          </apex:outputPanel>
                        </apex:outputPanel>
                      </div>
                      <div class="slds-size--1-of-1">
                            <div id="NewCriteriaFieldError" style="display:none;"><font style="color:red">This is a required Field.</font></div>
                            <br/>
                            <apex:outputPanel id="newCritOper">
                            <apex:outputPanel rendered="{!OR(AND(newCriterion.Field != '', ParentFieldListForNewCriterion.size > 0, parentField != null), AND(newCriterion.Field != '', ParentFieldListForNewCriterion.size == 0))}">
                            Logic:
                            <br/>
                                <apex:selectList id="NewCriteriaOper" styleClass="slds-select" value="{!newCriterion.logic}" size="1">
                                <apex:actionSupport event="onchange" action="{!updateCriteriaInformationText}" rerender="newCritVal, fkObjFields1, newCriteriaInformation, msgs" status="loading"/>
                                <apex:selectOptions value="{!FilterOperators}"/>
                                </apex:selectList>
                                <div id="NewCriteriaOperError" style="display:none;"><font style="color:red">This is a required Field.</font></div>
                            </apex:outputPanel>    
                            </apex:outputPanel>    
                            <br/>
                            <apex:outputPanel id="newCritVal">
                            <apex:outputPanel rendered="{!IF(newCriterion.logic != '', true, false)}">
                            Condition:
                            <br/>
                                    <apex:outputPanel layout="block" id="filterDataEntry1" rendered="{!NOT(hasCriteriaPicklist)}"> 
                                        <apex:inputText styleClass="slds-input" value="{! filterCondition }"/>
                                    </apex:outputPanel><div id="newConditionError" style="display:none"></div>
                                    
                                    <apex:outputPanel layout="block" id="filterPicklist1" rendered="{!hasCriteriaPicklist}"> 
                                        <apex:selectList size="1" styleClass="slds-select" value="{! filterCondition }" rendered="{!NOT(allowMultiselect)}">
                                            <apex:actionSupport event="onchange" action="{!updateCriteriaInformationText}" rerender="filterCriteriaVar1, setDateVar1, newCriterionButtons, newCriteriaInformation" status="loading"/>
                                            <apex:selectOptions value="{! filterCriteriaOptions }"/> 
                                        </apex:selectList>
                                        <apex:outputPanel id="newCriteriaInformation">
                                            <apex:outputPanel rendered="{!newCriterionInfo != null}">
                                                <div class="slds-notify_container">
                                                    <div class="slds-notify slds-notify--toast slds-theme--warning" role="alert">
                                                        <b>{!newCriterionInfo}</b>
                                                    </div>
                                                </div>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <apex:selectList size="3" multiselect="true" styleClass="slds-select" value="{! filterConditions }" rendered="{!allowMultiselect}">
                                            <apex:actionSupport event="onchange" action="{!buildCriterionStringFromMultiselect}" rerender="filterCriteriaVar1, setDateVar1, newCriterionButtons" status="loading"/>
                                            <apex:selectOptions value="{! filterCriteriaOptions }"/> 
                                        </apex:selectList>
                                        
                                        <apex:outputPanel id="filterCriteriaVar1" >
                                            <apex:outputPanel rendered="{!hasFilterCriteriaVariable}">
                                                <br/>
                                                <apex:outputText value="Number"/>
                                                <br/>                       
                                                <apex:inputText id="newFilterCon" styleClass="slds-input" value="{! filterConditionVar }"/>
                                                <div id="newCriteriaVariableError" style="display:none;"><font style='color:red'>You must input a number before saving.</font></div>
                                            </apex:outputPanel>
                                        </apex:outputPanel> 
                                        
                                        <apex:outputPanel id="setDateVar1" >  
                                            <apex:outputPanel rendered="{!hasDateSelect}" id="panelForSelectDate1">
                                                <br/> 
                                                <apex:outputText value="Date" rendered="{!hasDateSelect}"/>
                                                <br/>
                                                <script>
                                                    //Verify namespace is ready
                                                    var dsh = dsh || {};
                                                    dsh.j$ = jQuery.noConflict();    
                                                    
                                                    dsh.j$(function() {
                                                       dsh.j$( '[id$=datetimepicker1]' ).datetimepicker();
                                                       dsh.j$( '[id$=datepicker1]' ).datepicker();
                                                    });
                                                </script>
                                                <apex:inputText styleClass="slds-input" id="datepicker1" value="{!datePicker}" rendered="{!hasSelectDateVariable}"/>
                                                <apex:inputText styleClass="slds-input" id="datetimepicker1" value="{!dateTimePicker}" rendered="{!hasSelectDateTimeVariable}"/>
                                                <br/>
                                                <apex:outputText value="(ex: 01/11/2011 01:00)" rendered="{!hasSelectDateTimeVariable}"/>        
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                            </apex:outputPanel>     
                            </apex:outputPanel> 
                    </div>
                  </div>

              </div>
              
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <apex:outputPanel id="newCriterionButtons">
                  <button type="button" class="slds-button slds-button--neutral" onClick="hideAllModals();">Cancel</button>
                  <button type="button" class="slds-button slds-button--neutral" onClick="addAdditionalCriterion();">Add Additional Filter</button>
                  <button type="button" class="slds-button slds-button--neutral" onClick="saveSettingCriteria({!hasFilterCriteriaVariable});">Save</button>
                  </apex:outputPanel>
                </div>
              </div>
            </apex:outputPanel>  
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / New Filter Criteria -->
        
<!-- Edit Criterion -->
        <div id="editCriterion" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Edit Filter</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="clearSelectedCriterion();hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <apex:outputPanel id="EditCriterionModal">
              <div class="slds-modal__content">
                <div class="slds-grid slds-wrap">
                      <div id="editFieldSelection" class="slds-size--1-of-1">
                        <apex:outputPanel id="editFields">
                            <p style="float:left;">Field:</p> 
                            <p style="float:right;"><c:Paginate pageController="{!fieldsController}" renderedComponent="editFields" statusDisplay="loading"/></p>
                            <apex:selectList styleClass="slds-select" value="{!editCriterion.Field}" id="filterField" size="4"> 
                            <apex:actionSupport event="onchange" action="{!clearFilterOperator}" rerender="filterCondition, filterValue, fkObjFields2, editCriteriaInformation" oncomplete="setFildSelectListSize('edit', {!ParentFieldListForEditCriterion.size});" status="loading">
                              <apex:param assignTo="{!context}" value="target" name="parentFieldContext2"/>
                            </apex:actionSupport>
                            <apex:selectOptions value="{!FieldList}"/>
                            </apex:selectList>
                        </apex:outputPanel>
                      </div>  
                      <div id="editFKSelection" class="slds-size--1-of-2">
                        <apex:outputPanel id="fkObjFields2">
                          <apex:outputPanel rendered="{!ParentFieldListForEditCriterion.size > 0}">
                            <p style="float:left;">&nbsp;</p>
                            <p style="float:right;"><c:Paginate pageController="{!parentFieldsController}" renderedComponent="fkObjFields2" statusDisplay="loading"/></p>
                            <apex:selectList styleClass="slds-select" value="{!parentField}" size="4"> 
                            <apex:actionSupport event="onchange" action="{!clearFilterOperator}" rerender="filterCondition, filterValue, editCriteriaInformation" status="loading">
                              <apex:param assignTo="{!context}" value="parent" name="parentFieldContext2"/>
                            </apex:actionSupport>
                            <apex:selectOptions value="{!ParentFieldListForEditCriterion}"/> 
                            </apex:selectList>
                          </apex:outputPanel>
                        </apex:outputPanel>
                      </div>
                      <div class="slds-size--1-of-1"> 
                        <div id="EditCriteriaFieldError" style="display:none;"><font style="color:red">This is a required Field.</font></div>
                        <br/>
                        <apex:outputPanel id="filterCondition">
                        <apex:outputPanel rendered="{!OR(AND(editCriterion.Field != '', ParentFieldListForEditCriterion.size > 0, parentField != null), AND(editCriterion.Field != '', ParentFieldListForEditCriterion.size == 0))}">
                        Logic:
                        <br/>
                            <apex:selectList id="EditCriteriaOper" styleClass="slds-select" value="{!editCriterion.Logic}" size="1">
                                <apex:actionSupport event="onchange" action="{!updateCriteriaInformationText}" rerender="filterValue, editCriteriaInformation" status="loading"/>
                                <apex:selectOptions value="{!FilterOperators}"/>
                            </apex:selectList>
                            <div id="EditCriteriaOperError" style="display:none;"><font style="color:red">This is a required Field.</font></div>
                        </apex:outputPanel>
                        </apex:outputPanel>
                        <br/>
                        <apex:outputPanel id="filterValue">
                        <apex:outputPanel rendered="{!IF(editCriterion.Logic != '', true, false)}">
                        Condition:
                        <br/>
                                    <apex:outputPanel layout="block" id="filterDataEntry2" rendered="{!NOT(hasCriteriaPicklist)}"> 
                                        <apex:inputText styleClass="slds-input" value="{! filterCondition }"/>
                                    </apex:outputPanel><div id="editConditionError" style="display:none"></div>
                                    
                                    <apex:outputPanel layout="block" id="filterPicklist2" rendered="{!hasCriteriaPicklist}"> 
                                        
                                        <apex:selectList size="1" styleClass="slds-select" value="{! filterCondition }" rendered="{!NOT(allowMultiselect)}">
                                            <apex:actionSupport event="onchange" action="{!updateCriteriaInformationText}" rerender="filterCriteriaVar2, setDateVar2, editCriterionButtons, editCriteriaInformation" status="loading"/>
                                            <apex:selectOptions value="{! filterCriteriaOptions }"/> 
                                        </apex:selectList>
                                        <apex:outputPanel id="editCriteriaInformation">
                                            <apex:outputPanel rendered="{!editCriterionInfo != null}">
                                                <div class="slds-notify_container">
                                                    <div class="slds-notify slds-notify--toast slds-theme--warning" role="alert">
                                                        <b>{!editCriterionInfo}</b>
                                                    </div>
                                                </div>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <apex:selectList size="3" multiselect="true" styleClass="slds-select" value="{! filterConditions }" rendered="{!allowMultiselect}">
                                            <apex:actionSupport event="onchange" action="{!buildCriterionStringFromMultiselect}" rerender="filterCriteriaVar2, setDateVar2, newCriterionButtons" status="loading"/>
                                            <apex:selectOptions value="{! filterCriteriaOptions }"/> 
                                        </apex:selectList>
                                        <apex:outputPanel id="filterCriteriaVar2" >
                                            <apex:outputPanel rendered="{!hasFilterCriteriaVariable}">
                                                <br/>
                                                <apex:outputText value="Number"/>
                                                <br/>                       
                                                <apex:inputText id="editFilterCon" styleClass="slds-input" value="{! filterConditionVar }"/>
                                                <div id="editCriteriaVariableError" style="display:none;"><font style='color:red'>You must input a number before saving.</font></div>
                                            </apex:outputPanel>
                                        </apex:outputPanel> 
                                        
                                        <apex:outputPanel id="setDateVar2" >  
                                            <apex:outputPanel rendered="{!hasDateSelect}" id="panelForSelectDate2">
                                                <br/> 
                                                <apex:outputText value="Date" rendered="{!hasDateSelect}"/>
                                                <br/>
                                                <script>
                                                    //Verify namespace is ready
                                                    var dsh = dsh || {};
                                                    dsh.j$ = jQuery.noConflict();    
                                                    
                                                    dsh.j$(function() {
                                                       dsh.j$( '[id$=datetimepicker2]' ).datetimepicker();
                                                       dsh.j$( '[id$=datepicker2]' ).datepicker();
                                                    });
                                                </script>
                                                <apex:inputText styleClass="slds-input" id="datepicker2" value="{!datePicker}" rendered="{!hasSelectDateVariable}"/>
                                                <apex:inputText styleClass="slds-input" id="datetimepicker2" value="{!dateTimePicker}" rendered="{!hasSelectDateTimeVariable}"/>
                                                <br/>
                                                <apex:outputText value="(ex: 01/11/2011 01:00)" rendered="{!hasSelectDateTimeVariable}"/>        
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                        </apex:outputPanel>
                        </apex:outputPanel>
                    </div>
                    </div>

              </div>
              </apex:outputPanel>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <apex:outputPanel id="editCriterionButtons">
                  <button type="button" class="slds-button slds-button--neutral" onclick="hideAllModals();">Cancel</button>
                  <button type="button" onclick="updateSettingCriteria({!hasFilterCriteriaVariable});" class="slds-button slds-button--neutral">Update</button>
                  </apex:outputPanel>
                </div>
              </div>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / Edit Criterion -->

<!-- Activate Setting -->
      <div id="activateSetting" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Storage Recycle Job Activation</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
                <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px">
                <apex:outputPanel id="activationNotification">
                  <center>
                  <apex:outputPanel rendered="{!!settingConfig.SH2__Force_Preview__c}">
                    <b>Please Note: To prevent important data from being deleted accidentally, we recommend keeping the Storage Recycle Job inactive until the deletion filters are fully defined.</b>
                  </apex:outputPanel>
                  <apex:outputPanel rendered="{!settingConfig.SH2__Force_Preview__c}">
                    <b>The list of records below contains a preview of records that will be deleted by this Storage Recycle Job. Please confirm that the records found in the list below meet your desired filters.</b>
                  </apex:outputPanel>
                  </center>
                </apex:outputPanel>
                </div>
                <apex:outputPanel id="activationPreview">
                    <c:DSH_RecordPreview setting="{!selectedSetting}" hasOwnerFld="{!hasOwnerField}" pageController="{!previewController}" rendered="{!AND(settingConfig.SH2__Force_Preview__c, renderRecordPreview)}"/>
                </apex:outputPanel>
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <button type="button" class="slds-button slds-button--neutral" onclick="hideAllModals();">Keep Inactive</button>
                  <button type="button" onclick="activateSetting();" class="slds-button slds-button--neutral">Activate</button>
                </div>
              </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
      </div>
<!-- /Activate Setting -->

<!-- Deletion Warning -->
      <div id="deletionWarning" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Deletion Warning</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
                <apex:outputPanel id="deletionWarningMessage">
                <center>
                <div class="slds-notify_container">
                  <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px" role="alert">
                    <span class="slds-assistive-text">Error</span>
                    <div class="slds-notify__content slds-grid">
                      <div class="slds-col slds-align-middle">
                        <div class="slds-text-longform">
                          <apex:outputPanel rendered="{!srjHasBackupFiles}">
                          <b>Warning: Deleting this Storage Recylce Job, will also delete all of the backup files created by Storage Helper for this Storage Recycle Job. 
                          If you would like to keep the backup files you may click the 'View Backup Files' button below, then download the backups you would like to keep.
                          </b>
                          </apex:outputPanel>
                          <apex:outputPanel rendered="{!!srjHasBackupFiles}">
                          <b>Are you sure you would like to delete this Storage Recycle Job?
                          </b>
                          </apex:outputPanel>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                </center>
                </apex:outputPanel>
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <apex:outputPanel id="deletionButtons">
                  <button type="button" class="slds-button slds-button--neutral" onclick="hideAllModals();">Cancel</button>
                  <apex:outputPanel rendered="{!srjHasBackupFiles}">
                  <button type="button" class="slds-button slds-button--neutral" onclick="showBackupDownload();">View Backup Files</button>
                  </apex:outputPanel>
                  <button type="button" onclick="deleteSeletedSetting();hideAllModals();" class="slds-button slds-button--neutral">Delete</button>
                  </apex:outputPanel>
                </div>
              </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
      </div>
<!-- /Deletion Warning -->

<!-- Backup Settings -->
      <div id="backupConfig" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Storage Helper Backups</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content" style="min-height:190px;">
                <apex:outputPanel id="backupSettingFields">
                Backup Mode:<br/>
                <apex:selectList size="1" styleClass="slds-select" value="{! selectedSetting.Backup_Mode__c }">
                  <apex:actionSupport event="onchange" rerender="fieldBackupSelect, srjConfigButtons, cascadeDeleteObjects, indexArchives" status="loading"/>
                  <apex:selectOptions value="{!BackupModes}"/>
                </apex:selectList>
                
                <apex:outputPanel id="indexArchives">
                  <apex:outputPanel rendered="{!IF(OR(selectedSetting.SH2__Backup_Mode__c == 'Backup All Fields', selectedSetting.SH2__Backup_Mode__c == 'Select Fields To Backup'), true, false)}">
                    Enable Search For Archived Records:
                    <img width="18px" height="18px" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/info_60.png')}" onmouseover="dsh.j$('#searchInfo').toggle();" onmouseout="dsh.j$('#searchInfo').toggle();"/><br/>
                        <div class="slds-col" style="max-height:20px;">
                            <div id="searchInfo" class="slds-popover slds-theme--info" role="dialog" style="display:none">
                              <div class="slds-popover__body">This enables the ability to search records that are backed up by Storage Helper. Please note that a small amount of data storage will be used with this setting enabled.
                              </div>
                            </div>
                        </div>
                    <apex:inputCheckbox style="height:17px;width:17px;" value="{!selectedSetting.SH2__Index_Archived_Records__c}"/>
                  </apex:outputPanel>
                </apex:outputPanel>
                
                <apex:outputPanel id="fieldBackupSelect">
                  <apex:outputText style="color:red;" rendered="{!AND(selectedSetting.SH2__Backup_Mode__c == 'Backup All Fields', UnableToBackupAllFields)}" value="The object this Storage Recycle Job is created for contains more than 300 fields. The maximum number of fields that can be backed up is 300. Please change the backup mode to select which fields to backup."/>
                  <apex:outputPanel rendered="{!IF(selectedSetting.SH2__Backup_Mode__c == 'Select Fields To Backup', true, false)}">
                    <center>
                    <apex:outputText style="color:red;" value="Before saving you must select one or more field to backup." rendered="{!mainbackupFieldsController.SelectedListSize == 0}"/>
                    <apex:outputText style="color:red;" rendered="{!mainbackupFieldsController.UnableToAddMoreItems}" value="Unable to backup more than 300 fields."/>
                    </center>
                    <br/>
                    <table>
                    <tr>
                    <td class="slds-size--3-of-7">
                    <apex:outputPanel id="availableFields">
                    <center>Available Fields</center>
                    <apex:selectList size="10" style="min-height:342px;" styleClass="slds-select" value="{!mainbackupFieldsController.itemsToAdd}" multiselect="true">
                      <apex:selectOptions value="{!mainbackupFieldsController.available}"/>
                    </apex:selectList>
                    <c:Paginate pageController="{!mainbackupFieldsController.availableValueController}" renderedComponent="availableFields" statusDisplay="loading"/>
                    </apex:outputPanel>
                    </td>
                    <td class="slds-size--1-of-7">
                      <center>
                        <apex:commandButton styleclass="slds-button slds-button--neutral" style="max-height:30px;" image="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/right_60.png')}" action="{!updateBackupFieldLists}" rerender="fieldBackupSelect, srjConfigButtons" disabled="{!mainBackupFieldsController.UnableToAddMoreItems}" status="loading">
                          <apex:param assignTo="{!backupFieldSelectionContext}" value="add" name="addField"/>
                        </apex:commandButton><br/><br/>
                        <apex:commandButton styleclass="slds-button slds-button--neutral" style="max-height:30px;" image="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/left_60.png')}" action="{!updateBackupFieldLists}" rerender="fieldBackupSelect, srjConfigButtons" status="loading">
                          <apex:param assignTo="{!backupFieldSelectionContext}" value="remove" name="removeField"/>
                        </apex:commandButton>
                      </center>                     
                    </td>
                    <td class="slds-size--3-of-7">
                    <apex:outputPanel >  
                    <center>Selected Fields</center>
                    <apex:selectList size="10" style="min-height:342px;" styleClass="slds-select" value="{!mainbackupFieldsController.itemsToRemove}" multiselect="true">
                      <apex:selectOptions value="{!mainbackupFieldsController.selected}"/>
                    </apex:selectList>
                    <apex:outputPanel rendered="{!AND(mainbackupFieldsController != null, mainbackupFieldsController.availableValueController != null, mainbackupFieldsController.availableValueController.listObjects.size>700)}"><br/><br/></apex:outputPanel>
                    </apex:outputPanel>
                    </td>
                    </tr>
                    </table>
                  </apex:outputPanel>
                
                <apex:outputPanel id="backupChildWarning" rendered="{!AND(ChildObjectsWithTooManyFieldsToBackup.size > 0, selectedSetting.SH2__Backup_Mode__c != 'Off')}">
                  <div class="slds-notify_container" onClick="showBackupChildObjects();">
                    <div class="slds-notify slds-notify--alert slds-theme--alert-texture" style="min-width:0px" role="alert">
                      <div class="slds-text-longform">
                      <span class="slds-assistive-text">Required Cascade Deletion Objects</span>
                      <center>
                      <b>
                      <apex:commandLink rerender="none" onClick="showBackupChildObjects();"><h2>Cascade delete objects that contain too many fields to backup were found. Please click here to select which fields to backup for the objects found.</h2></apex:commandLink>
                      </b>
                      </center>
                      </div>
                    </div>
                  </div>
                </apex:outputPanel>
                
                </apex:outputPanel>
                </apex:outputPanel>
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <apex:outputPanel id="srjConfigButtons">
                  <button type="button" class="slds-button slds-button--neutral" onclick="hideAllModals();">Cancel</button>
                  <apex:commandbutton rendered="{!backupEditMode}" action="{!updateSRJBackupConfig}" status="loading" value="Save" disabled="{!OR(AND(selectedSetting.SH2__Backup_Mode__c == 'Select Fields To Backup', mainBackupFieldsController.SelectedListSize == 0), AND(selectedSetting.SH2__Backup_Mode__c == 'Backup All Fields', mainBackupFieldsController.UnableToAddMoreItems))}" styleclass="slds-button slds-button--neutral" reRender="activationPreview, backupInfoPanel" onComplete="hideAllModals();"/>
                  <apex:commandbutton rendered="{!!backupEditMode}" action="{!updateSRJBackupConfig}" status="loading" value="Next" disabled="{!OR(AND(selectedSetting.SH2__Backup_Mode__c == 'Select Fields To Backup', mainBackupFieldsController.SelectedListSize == 0), AND(selectedSetting.SH2__Backup_Mode__c == 'Backup All Fields', mainBackupFieldsController.UnableToAddMoreItems))}" styleclass="slds-button slds-button--neutral" reRender="activationPreview, backupInfoPanel" onComplete="displayActivationConfigAfterBackupConfig();"/>
                  </apex:outputPanel>
                </div>
              </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
      </div>
<!-- /Backup Settings -->

<!-- Cascade Delete Children -->
      <div id="cascadeDeleteObjectList" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Storage Helper Backups</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideChildBackupConfig();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
                <apex:outputPanel id="cascadeDeleteObjects">
                <div class="slds-notify_container">
                  <div class="slds-notify slds-notify--alert slds-theme--alert-texture" style="min-width:0px" role="alert">
                    <div class="slds-text-longform">
                    <span class="slds-assistive-text">Required Cascade Deletion Objects</span>
                    <b>
                    <h2>Below is a list of child objects that will be cascade deleted, but have too many fields to backup. To ensure the important fields are being backed up, click 'Select Fields To Backup' link next to the child objects to configure what fields will be backed up.<br/>
                    <br/>
                    If the backup fields are not configured, Storage Helper will select 300 fields at random.</h2>
                    </b>
                    </div>
                  </div>
                </div>
              <apex:outputPanel id="backupChildObjectTable">
                <table class="slds-table slds-table--bordered">
                  <thead>
                    <tr class="slds-no-hover">
                      <th class="slds-text-heading--label slds-size--3-of-5" scope="col">Object Name</th>
                      <th class="slds-text-heading--label slds-size--2-of-5" scope="col"><center>Backup Configuration</center></th>
                    </tr>
                  </thead>
                  <tbody>
                    <apex:repeat value="{!childObjectsWithTooManyFieldsToBackup}" var="o">
                      <tr class="slds-hint-parent">
                        <td>{!o}</td>
                        <td><center>
                          <apex:commandLink value="Select Fields To Backup" action="{!clearCascadeBackupController}" rerender="cascadeDeleteFields" status="loading" oncomplete="showChildBackupModal();">
                            <apex:param assignTo="{!cascadeDeleteObject}" value="{!o}" name="childObjectName"/>
                          </apex:commandLink>
                        </center></td>
                      </tr>
                    </apex:repeat>
                  </tbody>
                </table>
              </apex:outputPanel>
              </apex:outputPanel>
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <apex:outputPanel id="cascadeObjectsButtons">
                  <button type="button" class="slds-button slds-button--neutral" onclick="hideChildBackupConfig();">Back</button>
                  </apex:outputPanel>
                </div>
              </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
      </div>
<!-- /Cascade Delete Children -->

<!-- Cascade Delete Backup Fields -->
      <div id="cascadeDeleteBackup" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Storage Helper Backups</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="clearCascadeDeleteSettings();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <apex:outputPanel id="cascadeDeleteFields">
              <div class="slds-modal__content">
                <apex:outputPanel id="cascadeFieldBackupSelect">
                    <center>
                    <apex:outputText style="color:red;" value="Before saving you must select one or more field to backup." rendered="{!childBackupFieldsController.SelectedListSize == 0}"/>
                    <apex:outputText style="color:red;" rendered="{!childBackupFieldsController.UnableToAddMoreItems}" value="Unable to backup more than 300 fields."/>
                    </center>
                    <br/>

                    <table>
                    <tr>
                    <td class="slds-size--3-of-7">
                    <apex:outputPanel id="cascadeAvailableFields">
                    <center>Available Fields</center>
                    <apex:selectList size="10" style="min-height:342px;" styleClass="slds-select" value="{!childBackupFieldsController.itemsToAdd }" multiselect="true">
                      <apex:selectOptions value="{!childBackupFieldsController.available}"/>
                    </apex:selectList>
                    <c:Paginate pageController="{!childBackupFieldsController.availableValueController}" renderedComponent="cascadeAvailableFields" statusDisplay="loading"/>
                    </apex:outputPanel>
                    </td>
                    <td class="slds-size--1-of-7">
                      <center>
                        <apex:commandButton styleclass="slds-button slds-button--neutral" style="max-height:30px;" image="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/right_60.png')}" action="{!updateBackupFieldLists}" rerender="cascadeFieldBackupSelect, cascadeConfigButtons" disabled="{!childBackupFieldsController.UnableToAddMoreItems}" status="loading">
                          <apex:param assignTo="{!backupFieldSelectionContext}" value="childAdd" name="addChildField"/>
                        </apex:commandButton><br/><br/>
                        <apex:commandButton styleclass="slds-button slds-button--neutral" style="max-height:30px;" image="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/left_60.png')}" action="{!updateBackupFieldLists}" rerender="cascadeFieldBackupSelect, cascadeConfigButtons" status="loading">
                          <apex:param assignTo="{!backupFieldSelectionContext}" value="childRemove" name="removeChildField"/>
                        </apex:commandButton>
                      </center>                     
                    </td>
                    <td class="slds-size--3-of-7">
                    <apex:outputPanel >  
                    <center>Selected Fields</center>
                    <apex:selectList size="10" style="min-height:342px;" styleClass="slds-select" value="{!childBackupFieldsController.itemsToRemove }" multiselect="true">
                      <apex:selectOptions value="{!childBackupFieldsController.selected}"/>
                    </apex:selectList>
                    <apex:outputPanel rendered="{!AND(childBackupFieldsController != null, childBackupFieldsController.availableValueController != null, childBackupFieldsController.availableValueController.listObjects.size>700)}"><br/><br/></apex:outputPanel>
                    </apex:outputPanel>
                    </td>
                    </tr>
                    </table>
                </apex:outputPanel>
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <apex:outputPanel id="cascadeConfigButtons">
                  <button type="button" class="slds-button slds-button--neutral" onclick="clearCascadeDeleteSettings();">Cancel</button>
                  <apex:commandbutton action="{!updateSRJBackupConfig}" rerender="backupInfoPanel" status="loading" value="Save" disabled="{!OR(childBackupFieldsController.SelectedListSize == 0, childBackupFieldsController.UnableToAddMoreItems)}" styleclass="slds-button slds-button--neutral" onComplete="showBackupChildObjects();"/>
                  </apex:outputPanel>
                </div>
              </div>
              </apex:outputPanel>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
      </div>
<!-- /Cascade Delete Backup Fields -->

<!-- Backup Download -->
      <div id="backupDownload" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium">Storage Helper Backup Files</h2>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
                <apex:outputPanel id="backupDownloadConfig">
                Select What Backup Files to Display:
                <apex:selectList styleClass="slds-select" value="{!downloadBackupFileMode}" size="1">
                  <apex:actionSupport event="onchange" action="{!buildBackupPaginationController}" rerender="backupTable" status="loading"/>
                  <apex:selectOption itemValue="" itemLabel="None"/>
                  <apex:selectOption itemValue="all" itemLabel="All Backup Files"/>
                  <apex:selectOption itemValue="range" itemLabel="Backup Files Created In a Given Date Range"/>
                </apex:selectList>
                <apex:outputPanel id="backupError">
                    <center><apex:outputText value="{!backupFileMessage}" style="color:red;" rendered="{!backupFileMessage != null}"/></center>
                </apex:outputPanel>
                <apex:outputPanel id="backupTable">
                  <apex:outputPanel rendered="{!downloadBackupFileMode == 'range'}">
                    <script>
                        //Verify namespace is ready
                        var dsh = dsh || {};
                        dsh.j$ = jQuery.noConflict();    
                        
                        dsh.j$(function() {
                           dsh.j$( '[id$=fromDate]' ).datepicker();
                           dsh.j$( '[id$=toDate]' ).datepicker();
                        });
                    </script>
                    <div class="slds-grid">
                      <div class="slds-size--1-of-2 slds-m-around--x-small">
                      From Date: <apex:inputText id="fromDate" styleClass="slds-input" value="{!backupFromDate}"/><br/>
                      </div>
                      <div class="slds-size--1-of-2 slds-m-around--x-small">
                      To Date: <apex:inputText id="toDate" styleClass="slds-input" value="{!backupToDate}"/>
                      </div>
                    </div>
                    <center><apex:commandButton action="{!buildBackupPaginationController}" rerender="csvTable, backupError" status="loading" value="Find Backup Files" styleclass="slds-button slds-button--neutral"/></center>
                  </apex:outputPanel>
                  <apex:outputPanel id="csvTable">
                    <apex:outputPanel rendered="{!AND(OR(AND(downloadBackupFileMode == 'range', OR(backupFromDate != null , backupToDate != null)), downloadBackupFileMode == 'all'), backupFileMessage == null, BackupAttachments.size > 0)}">
                      <br/>
                      <center><apex:outputText value="A maximum of 10,000 backup files have been retrieved. If the backup file you are looking for is not in the list, try searching with a reduced date range." style="color:red;" rendered="{!BackupAttachments.size >= 10000}"/></center>
                      <table class="slds-table slds-table--bordered slds-scrollable--x" style="max-height:200px">
                        <thead>
                          <tr class="slds-no-hover">
                            <th class="{!IF(hasOwnerField, 'slds-text-heading--label slds-size--2-of-5', 'slds-text-heading--label slds-size--4-of-5')}" scope="col">Backup Name</th>
                            <th class="slds-text-heading--label slds-size--1-of-5" scope="col">Download</th>
                          </tr>
                        </thead>
                        <tbody>
                          <apex:repeat value="{!BackupAttachments}" var="r">
                            <tr class="slds-hint-parent">
                                <td class="slds-size--2-of-5 slds-truncate" style="max-width:220px;" data-label="{!recordNameField}">
                                  <apex:outputLink value="/{!r.recId}" target="_blank" rendered="{! $User.UIThemeDisplayed == 'Theme3' }">{!r.name}</apex:outputLink>
                                  <apex:outputLink value="/{!r.recId}" rendered="{! $User.UIThemeDisplayed != 'Theme3' }">{!r.name}</apex:outputLink><br/>
                                </td>
                                <td class="slds-size--1-of-5 slds-truncate" data-label="delete">
                                  <apex:outputLink value="/servlet/servlet.FileDownload?file={!r.recId}" target="_blank">Download</apex:outputLink>
                                </td>
                            </tr>
                          </apex:repeat>
                        </tbody>
                      </table>
                      <p style="float:right;"><c:Paginate pageController="{!backupController}" renderedComponent="csvTable" statusDisplay="loading"/></p>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!AND(backupAttachments.size == 0, downloadBackupFileMode != '')}">
                      <br/>
                      <center>No Backup Files Found.</center>
                    </apex:outputPanel>
                  </apex:outputPanel>
                </apex:outputPanel>
                </apex:outputPanel>
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <apex:outputPanel >
                  <button type="button" class="slds-button slds-button--neutral" onclick="hideAllModals();">Cancel</button>
                  </apex:outputPanel>
                </div>
              </div>
            </div>
        </div>
        <div class="slds-backdrop slds-backdrop--open"></div>
      </div>
<!-- /Backup Download -->
        
<!-- Setting Run Selection -->
        <div id="manualRun" style="display:none;">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header" style="padding:0px;">
                <div class="slds-notify_container">
                  <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px" role="alert">
                    <span class="slds-assistive-text">Error</span>
                    <div class="slds-notify__content slds-grid">
                      <div class="slds-col slds-align-middle">
                          <div class="slds-text-longform">
                            <h3 class="slds-text-heading--small"><b>Before clicking run, we recommend taking the following steps to ensure valuable data will not be lost:</b></h3>
                            <b>
                            <ul>
                              <li>Click the 'Preview Records' button on the detail tab for each Storage Recycle Job you plan to run.</li>
                              <li>Confirm all important data is backed up, or enable data backups in Storage Helper for each Storage Recycle Job you are going to run.</li>
                            </ul>
                            </b>
                          </div>
                      </div>
                    </div>
                  </div>
                </div>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideAllModals();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
                <apex:outputPanel id="manualRunComponent">
                    <div class="slds-modal__content">
                    <center>
                    <section class="slds-card__body">
                        <ul>
                        <li class="slds-tile slds-hint-parent">
                        <center>
                        <div class="slds-small-size--1-of-1 slds-medium-size--1-of-1 slds-large-size--1-of-1">
                            <div class="slds-scrollable--x"> 
                            <apex:outputPanel id="runSettings">
                                <apex:pageBlock >
                                    <apex:pageBlockTable value="{!activeSettingsToRun}" var="s" styleClass="slds-table slds-table--bordered" rendered="{!activeSettingsToRun.size > 0}">
                                        <center>
                                            <apex:column headerValue="Run">
                                                <apex:facet name="header">
                                                    <apex:inputCheckbox id="checkAllBox" value="{!selectAllToRun}">
                                                        <apex:actionSupport event="onclick" action="{!selectAllAction}" reRender="runSettings, runButtons" status="loading"/>
                                                    </apex:inputCheckbox>
                                                </apex:facet>
                                                <apex:inputCheckbox value="{!s.selected}">
                                                    <apex:actionSupport event="onchange" rerender="runButtons" status="loading"/>
                                                </apex:inputCheckbox>
                                            </apex:column>
                                            <apex:column headerValue="Setting Name">
                                                <p class="slds-truncate">{!s.settingName}</p>
                                            </apex:column>
                                            <apex:column headerValue="Object Name">
                                                <p class="slds-truncate">{!s.settingObject}</p>
                                            </apex:column>
                                        </center>
                                    </apex:pageBlockTable>
                                    <apex:outputPanel rendered="{!activeSettingsToRun.size == 0}">
                                        There are no active settings to run.
                                    </apex:outputPanel>
                                </apex:pageBlock>
                            </apex:outputPanel>
                            </div>
                        </div>
                        </center>
                        </li>
                        </ul>
                    </section>
                    </center>
                    </div>
            
                    <div class="slds-modal__footer">
                        <div class="slds-x-small-buttons--horizontal">
                         <apex:outputPanel id="runButtons">
                          <button type="button" class="slds-button slds-button--neutral" onClick="hideAllModals();">Cancel</button>
                          <apex:commandButton id="manualRunButton" styleClass="slds-button slds-button--neutral" onClick="runSettings();" value="Run" disabled="{!IF(numberOfSettingsToRun == 0, true, false)}" rerender="manualRunButton"/>
                         </apex:outputPanel>
                        </div>
                    </div>
                </apex:outputPanel>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / Setting Run Selection -->

<!-- Edit Schedule -->
        <div id="editSchedule" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
              <div class="slds-modal__header" style="padding:0px;">
                <div class="slds-notify_container">
                  <div class="slds-notify slds-notify--toast slds-theme--warning" style="min-width:0px" role="alert">
                    <span class="slds-assistive-text">Warning</span>
                    <div class="slds-notify__content slds-grid">
                      <div class="slds-col slds-align-middle">
                        <center>
                        <h2 class="slds-text-heading--small">Please make sure all important data is backed up before Storage Helper is scheduled to run, or Storage Helper backups are enabled for the active Storage Recycle Jobs.</h2>
                        </center>
                      </div>
                    </div>
                  </div>
                </div>
                <button type="button" class="slds-button slds-button--icon-inverse slds-modal__close" onClick="hideEditSchedule(''); showSettingConfig();">
                    <img width="60%" height="60%" src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/icons/utility/close_60.png')}"></img>
                  <span class="slds-assistive-text">Close</span>
                </button>
              </div>
              <div class="slds-modal__content">
              
              <apex:outputPanel id="setSchedule" >
                Run Mode: 
                    <apex:selectList id="selectedRunMode" styleClass="slds-select" value="{!settingConfig.SH2__Run_Mode__c}" size="1">
                    <apex:actionSupport event="onchange" rerender="scheduleInputs, dataExportError, saveRunMode, nextDataExport" onComplete="hideSettingConfig();" status="loading"/>  
                    <apex:selectOptions value="{!runModes}"/>
                    </apex:selectList>
                    <apex:outputPanel id="dataExportError">
                    <apex:outputText value="A Salesforce export has not been detected. " style="color:red;" rendered="{!runAfterExportError}"/>
                    <apex:outputLink value="/ui/setup/export/DataExportPage/d?setupid=DataManagementExport" target="_blank" rendered="{!runAfterExportError}">Click Here to create one.</apex:outputLink>
                    </apex:outputPanel>
                    <apex:outputPanel id="nextDataExport">
                    <apex:outputText rendered="{!AND(!runAfterExportError, settingConfig.SH2__Run_Mode__c == 'After Export')}">The Next Salesforce Data Export Will Run: {!NextDataExportTime}</apex:outputText>
                    </apex:outputPanel>
                <br/><br/>
                  <apex:outputPanel id="scheduleInputs">
                  <apex:outputPanel rendered="{!settingConfig.SH2__Run_Mode__c == 'Scheduled'}">
                      <apex:outputText value="Run Every:"/>
                      <br/>
                      <apex:inputText styleClass="slds-input" id="increment" style="width:50%;" value="{!increment}"/>
                      <apex:selectList styleClass="slds-select" style="width:50%;" value="{!settingConfig.SH2__Unit__c}" size="1">
                        <apex:selectOption itemValue="" itemLabel="- Select Unit -"/>
                        <apex:selectOption itemValue="hour" itemLabel="Hour"/>
                        <apex:selectOption itemValue="day" itemLabel="Day"/>
                        <apex:selectOption itemValue="month" itemLabel="Month"/>
                        <apex:selectOption itemValue="year" itemLabel="Year"/>
                      </apex:selectList>
                      <div id="incrementError" style="display:none;"><br/><font style="color:red">The scheduled increment must be a valid whole number greater than or equal to 1.</font></div>
                      <br/> 
                      <apex:outputText value="Next Scheduled Run"/>
                      <br/>
                      <apex:inputField styleClass="slds-input" id="nextRun" style="width:50%" value="{!settingConfig.SH2__Next_Scheduled_Run__c}"/>
                      <div id="nextRunError" style="display:none;"><br/><font style="color:red">You must populate a value in the next scheduled run field.</font></div>
                      <br/>
                      <apex:outputText value="(ex: 01/11/2011 01:00 PM)"/>        
                  </apex:outputPanel>
                  </apex:outputPanel>
              </apex:outputPanel>
                
              </div>
              <div class="slds-modal__footer">
                <div class="slds-x-small-buttons--horizontal">
                  <button type="button" class="slds-button slds-button--neutral" onClick="hideEditSchedule(''); showSettingConfig();">Cancel</button>
                  <apex:commandButton id="saveRunMode" onclick="saveSchedule();" styleClass="slds-button slds-button--neutral" value="Save" rerender="none" disabled="{!runAfterExportError}"/>
                </div>
              </div>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / Edit Schedule -->

<!-- Non-Profit Discount -->
    <div id="nfpDiscount" style="display:none">
        <c:NFPDiscountForm pageController="{!nfpController}"/>
    </div>
<!-- / Non-Profit Discount -->

<!--- Help screen -->
      <div id="helpScreen" style="display:none">
		    <c:DSH_FAQ />
      </div>

<!-- / Help screen -->
     
<!-- LOADING SCREEN -->
        <div id="loading" style="display:none">
          <div aria-hidden="false" role="dialog" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container" style="min-width: 50px; width: 100px;">
              <div class="slds-modal__content">
              <center>
              <div class="slds-spinner--large" background="#16325c">
                  <img src="{! URLFOR($Resource.SFStyleSheets, 'SFStyleSheets/assets/images/spinners/slds_spinner_brand.gif')}" alt="Loading..." />
              </div>
              </center>
              </div>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open"></div>
        </div>
<!-- / LOADING SCREEN -->

      <div class="slds-grid">
      <div class="slds-col slds-small-size--1-of-2 slds-medium-size--3-of-5 slds--large-size--8-of-12">
        <center>
        | <a href="mailto:support@passagetech.com">Contact Support</a> | <a href="https://appexchange.salesforce.com/listingDetail?listingId=a0N3000000B5fvwEAB&tab=r" target="_blank">Review Our AppExchange Listing</a> | <a href="https://www.passagetechnology.com" target="_blank">Visit Our Website</a> |
        </center>
      </div>
      <div class="column region-sidebar slds-small-size--1-of-2 slds-medium-size--2-of-5 slds-large-size--3-of-12"></div>
      </div>

    </div>
    <!-- / REQUIRED SLDS WRAPPER -->

    </apex:form>
    </body>
</html>

</apex:page>